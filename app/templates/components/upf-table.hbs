<div class='row upf-contextual-nav upf-datatable__actions-header'>
  <div class='pull-left'>
    {{#if contextualActionsComponent}}
      {{component contextualActionsComponent collection=collection}}
    {{/if}}
  </div>

  <div class='pull-right'>
    <a {{action 'toggleDisplayedColumnVisibilityPanel'}}
       class='upf-link--reset text-color-contrast text-size-6'>
      Display &nbsp;
      {{#if displayedColumnsPanel}}
        {{fa-icon 'caret-up'}}
      {{else}}
        {{fa-icon 'caret-down'}}
      {{/if}}
    </a>
  </div>
</div>

<div class="upf-datatable__side-panel
     {{if displayedColumnsPanel 'upf-datatable__side-panel--visible'}}">
  {{#each _columns as |column|}}
    <div class='margin-bottom-sm'>
      {{#upf-checkbox value=column.visible hasLabel=true}}
        <span class='text-color-contrast'>{{column.title}}</span>
      {{/upf-checkbox}}
    </div>
  {{/each}}
</div>

<table class='upf-datatable'>
  <thead>
    {{#upf-table/row isHeaderRow=true}}
      {{#if hasSelection}}
        <th width='45px' class='upf-datatable__column upf-datatable__column--unsortable'>
          {{upf-checkbox value=allRowsSelected}}
        </th>
      {{/if}}

      {{#each _columns as |column|}}
        {{#unless (eq column.visible false)}}
          <th width={{column.width}}
              class="upf-datatable__column {{if column.titleIcon 'text-size-6'}}">
            {{#if column.titleIcon}}
              {{fa-icon column.titleIcon}}
            {{else}}
              {{column.title}}
            {{/if}}
          </th>
        {{/unless}}
      {{/each}}
    {{/upf-table/row}}
  </thead>

  <tbody>
    {{#each collection as |item index|}}
      {{#upf-table/row ref=item}}
        {{#if hasSelection}}
          <td class='upf-datatable__column'>{{upf-checkbox value=item.selected}}</td>
        {{/if}}

        {{#each _columns as |column|}}
          {{#unless (eq column.visible false)}}
            <td valign='middle' class='upf-datatable__column {{column.additionalClasses}}'>
              {{#if column.component}}
                {{component column.component item=item column=column}}
              {{else}}
                {{#if (eq column.helper 'money')}}
                  {{format-money (get item column.property) (get item column.currency)}}
                {{else if (eq column.helper 'numeric')}}
                  {{format-numeric (get item column.property)}}
                {{else}}
                  {{get item column.property}}
                {{/if}}
              {{/if}}
            </td>
          {{/unless}}
        {{/each}}
      {{/upf-table/row}}
    {{/each}}
  </tbody>
</table>
